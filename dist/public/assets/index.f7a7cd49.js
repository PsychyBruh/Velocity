import{A as s,R as i}from"./RuntimeModifier.729da609.js";import{C as a,N as n,M as c,r as d,I as y}from"./index.596163ac.js";import{e as h,T as l,C as m,c as u}from"./Tab.baaf254f.js";import{o as f}from"./index.e8530d6e.js";import{p}from"./url.064866d1.js";import{K as w}from"./Keybind.d64ce3dc.js";import{P as x}from"./Protocol.b55961c7.js";import"./BareClient.06787bc0.js";class b extends h.exports{#t;constructor(){super(),this.#e().then(()=>{this.emit("ready")})}async#e(){const t=await f("history",1,{upgrade(e){e.createObjectStore("history",{keyPath:"id"})}});return this.#t=t,t}async add(t){return!this.#t||!t.url()||p.find(t.url())?void 0:await this.#t.transaction("history","readwrite").objectStore("history").put({id:t.historyId,timestamp:Date.now(),url:t.url()||"about:newTab",title:t.title(),favicon:t.icon()})}async get(){return this.#t?await this.#t.transaction("history","readonly").objectStore("history").getAll():[]}async delete(t){return this.#t?await this.#t.transaction("history","readwrite").objectStore("history").delete(t):void 0}async clear(){return this.#t?await this.#t.transaction("history","readwrite").objectStore("history").clear():void 0}}const g=new Proxy({Tab:l,getTabs:a,Protocol:x,getProtocols:n,Bookmark:c,getBookmarks:d,ContextItem:m,Keybind:w,getKeybinds:y,bindIFrameMousemove:u,history:new b,postManifest:!1,ExtensionReader:s,RuntimeModifier:i},{get(o,t,e){return["RuntimeModifier","history"].includes(t)||console.warn(`Using Velocity.${t} is deprecated, please use RuntimeModifier instead.`),Reflect.get(o,t,e)}});window.Velocity=g;export{g as default};
